{
  "title": "Business Intelligence Console",
  "servers": [
    {
      "name": "supabase",
      "transport": {
        "type": "stdio",
        "command": "npx",
        "args": ["-y", "@modelcontextprotocol/server-supabase"],
        "env": {
          "SUPABASE_URL": "${SUPABASE_URL}",
          "SUPABASE_SERVICE_KEY": "${SUPABASE_SERVICE_KEY}"
        }
      }
    },
    {
      "name": "memory",
      "transport": {
        "type": "stdio",
        "command": "npx",
        "args": ["-y", "@modelcontextprotocol/server-memory"],
        "env": {
          "MEMORY_STORE_PATH": "./.data/bi-notebook.json"
        }
      }
    },
    {
      "name": "charts",
      "transport": {
        "type": "stdio",
        "command": "npx",
        "args": ["-y", "@modelcontextprotocol/server-examples-charts"]
      }
    }
  ],
  "widgets": [
    {
      "package": "@mwp/widget-supabase",
      "serverName": "supabase",
      "id": "supabase-analytics",
      "position": { "x": 0, "y": 0 },
      "size": { "w": 5, "h": 6 },
      "options": {
        "defaultView": "metrics",
        "watchTables": ["orders", "customers", "subscriptions"],
        "enableQueryBuilder": true
      }
    },
    {
      "package": "@mwp/widget-memory",
      "serverName": "memory",
      "id": "insight-notes",
      "position": { "x": 5, "y": 0 },
      "size": { "w": 3, "h": 6 },
      "options": {
        "collections": ["bi-insights"],
        "view": "list"
      }
    },
    {
      "package": "@mwp/example-themed-chart-widget",
      "serverName": "charts",
      "id": "bi-visual",
      "position": { "x": 8, "y": 0 },
      "size": { "w": 4, "h": 6 },
      "options": {
        "dataset": "supabase.analytics.kpi_rollups",
        "visualization": "line"
      }
    }
  ],
  "eventBridges": [
    {
      "source": "supabase-analytics",
      "on": "supabase:query:executed",
      "emit": "memory:write-requested",
      "payloadTemplate": {
        "collection": "bi-insights",
        "tags": ["supabase", "kpi"],
        "content": "{{summary}}"
      }
    }
  ]
}
