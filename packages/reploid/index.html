<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' style='stop-color:%230ff;'/><stop offset='100%25' style='stop-color:%23ffd700;'/></linearGradient></defs><text fill='url(%23g)' y='.99em' font-size='90' font-weight='bold'>R</text></svg>" />
    <title>REPLOID - AI Assistant</title>
    <link rel="stylesheet" href="boot/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/acorn@8.12.1/dist/acorn.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
    <!-- Web LLM library loaded via esm.run CDN - loaded dynamically when needed by local-llm.js module -->
    <!-- <script type="module" src="https://esm.run/@mlc-ai/web-llm"></script> -->

    <!-- Firebase Analytics -->
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
      import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';

      const firebaseConfig = {
        apiKey: "AIzaSyBNjEuGLafsUde3ws_9_Zi-PUlKkWt-CWM",
        authDomain: "reploid.firebaseapp.com",
        projectId: "reploid",
        storageBucket: "reploid.firebasestorage.app",
        messagingSenderId: "506730551098",
        appId: "1:506730551098:web:1b9639865cb8501b7c2203",
        measurementId: "G-RL299QYBNB"
      };

      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
    </script>
</head>
<body>
    <div id="boot-container">
        <div class="boot-header">
            <h1>REPLOID</h1>
            <p class="subtitle">
                <a href="about.html" target="_blank" class="subtitle-link">[Experimental] Recursive Self-Improvement Ecosystem</a>
            </p>
        </div>

        <!-- Agent Setup Card -->
        <div class="agent-setup-card" aria-labelledby="agent-setup-title">
            <div class="agent-setup-top">
                <div>
                    <div id="agent-setup-title" class="agent-setup-title">Agent Setup</div>
                    <div class="agent-config-description">Powers your autonomous agent's reasoning and actions.</div>
                </div>
                <button id="config-btn" class="btn-config" aria-label="Open agent settings" title="Open agent settings">‚öô</button>
            </div>
            <div class="agent-model-row">
                <span class="agent-config-label">AI Model</span>
                <div class="agent-config-value">
                    <span id="provider-status" class="agent-model-name">Detecting‚Ä¶</span>
                    <span id="provider-status-detail" class="agent-model-detail"></span>
                </div>
            </div>
            <div class="agent-status-chips" role="status" aria-live="polite">
                <span id="agent-chip-server" class="status-chip status-chip--checking" aria-label="Server status: checking">Server ¬∑ Checking‚Ä¶</span>
                <span id="agent-chip-ollama" class="status-chip status-chip--inactive" aria-label="Ollama status: detecting">Ollama ¬∑ Detecting‚Ä¶</span>
            </div>
        </div>

        <div id="api-error-message" class="error-message hidden" role="alert">
            <strong>Server Offline</strong>
            <p>Reploid can‚Äôt reach <code>localhost:8000</code>.</p>
            <p><code>npm start</code> to boot the service, or read the <a href="https://github.com/clocksmith/deco/tree/main/docs" target="_blank" rel="noreferrer">setup guide</a>.</p>
        </div>

        <!-- Settings Modal -->
        <div id="config-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Settings</h3>
                    <button id="close-modal" class="close-btn">√ó</button>
                </div>
                <div class="modal-body">
                    <!-- Modal Tabs -->
                    <div class="modal-tabs">
                        <button class="modal-tab active" data-modal-tab="mode">Deployment Mode</button>
                        <button class="modal-tab" data-modal-tab="advanced">Advanced Settings</button>
                    </div>

                    <!-- Deployment Mode Tab Content -->
                    <div class="modal-tab-content active" id="modal-mode-tab">
                        <p class="modal-tab-description">Choose how Reploid connects to AI models. Each mode has different tradeoffs.</p>

                        <!-- Environment Detection & Recommendations -->
                        <div id="mode-recommendation" class="mode-recommendation hidden">
                            <div class="recommendation-header">
                                <span class="recommendation-icon">üí°</span>
                                <strong>Recommended Setup</strong>
                            </div>
                            <p id="recommendation-text" class="recommendation-text"></p>
                            <button type="button" id="use-recommended" class="btn secondary btn-sm">Use Recommended</button>
                        </div>

                        <!-- Mode Selection Cards -->
                        <div class="mode-cards">
                            <div class="mode-card" data-mode="local">
                                <div class="mode-card-header">
                                    <span class="mode-icon">üñ•Ô∏è</span>
                                    <h4 class="mode-title">Local (Ollama)</h4>
                                    <button type="button" class="mode-help-btn" data-help-mode="local" aria-label="Learn more about Local mode">‚ìò</button>
                                </div>
                                <ul class="mode-features">
                                    <li class="feature-pro">‚úÖ Completely free</li>
                                    <li class="feature-pro">‚úÖ Maximum privacy</li>
                                    <li class="feature-con">‚öôÔ∏è Requires Ollama</li>
                                </ul>
                                <button type="button" class="btn-select-mode" data-mode="local">Select</button>
                            </div>

                            <div class="mode-card" data-mode="cloud">
                                <div class="mode-card-header">
                                    <span class="mode-icon">‚òÅÔ∏è</span>
                                    <h4 class="mode-title">Cloud Provider</h4>
                                    <button type="button" class="mode-help-btn" data-help-mode="cloud" aria-label="Learn more about Cloud mode">‚ìò</button>
                                </div>
                                <ul class="mode-features">
                                    <li class="feature-pro">‚úÖ Fast & powerful</li>
                                    <li class="feature-pro">‚úÖ Advanced models</li>
                                    <li class="feature-con">üí≥ API costs apply</li>
                                </ul>
                                <button type="button" class="btn-select-mode" data-mode="cloud">Select</button>
                            </div>

                            <div class="mode-card" data-mode="browser">
                                <div class="mode-card-header">
                                    <span class="mode-icon">üåê</span>
                                    <h4 class="mode-title">Browser Only</h4>
                                    <button type="button" class="mode-help-btn" data-help-mode="browser" aria-label="Learn more about Browser mode">‚ìò</button>
                                </div>
                                <ul class="mode-features">
                                    <li class="feature-pro">‚úÖ No setup needed</li>
                                    <li class="feature-con">‚ö†Ô∏è Limited features</li>
                                    <li class="feature-con">üêå Slower inference</li>
                                </ul>
                                <button type="button" class="btn-select-mode" data-mode="browser">Select</button>
                            </div>

                            <div class="mode-card" data-mode="hybrid">
                                <div class="mode-card-header">
                                    <span class="mode-icon">üîÑ</span>
                                    <h4 class="mode-title">Hybrid (Auto)</h4>
                                    <button type="button" class="mode-help-btn" data-help-mode="hybrid" aria-label="Learn more about Hybrid mode">‚ìò</button>
                                </div>
                                <ul class="mode-features">
                                    <li class="feature-pro">‚úÖ Cost optimized</li>
                                    <li class="feature-pro">‚úÖ Auto-switching</li>
                                    <li class="feature-con">‚öôÔ∏è Ollama + API key</li>
                                </ul>
                                <button type="button" class="btn-select-mode" data-mode="hybrid">Select</button>
                            </div>

                            <div class="mode-card" data-mode="multi">
                                <div class="mode-card-header">
                                    <span class="mode-icon">üè¢</span>
                                    <h4 class="mode-title">High Availability</h4>
                                    <button type="button" class="mode-help-btn" data-help-mode="multi" aria-label="Learn more about High Availability mode">‚ìò</button>
                                </div>
                                <ul class="mode-features">
                                    <li class="feature-pro">‚úÖ Never fails</li>
                                    <li class="feature-pro">‚úÖ Best quality</li>
                                    <li class="feature-con">üí∞ 3x cost</li>
                                </ul>
                                <button type="button" class="btn-select-mode" data-mode="multi">Select</button>
                            </div>

                            <div class="mode-card" data-mode="custom">
                                <div class="mode-card-header">
                                    <span class="mode-icon">üîß</span>
                                    <h4 class="mode-title">Custom Endpoint</h4>
                                    <button type="button" class="mode-help-btn" data-help-mode="custom" aria-label="Learn more about Custom mode">‚ìò</button>
                                </div>
                                <ul class="mode-features">
                                    <li class="feature-pro">‚úÖ Your infrastructure</li>
                                    <li class="feature-pro">‚úÖ Enterprise ready</li>
                                    <li class="feature-con">üîß Advanced setup</li>
                                </ul>
                                <button type="button" class="btn-select-mode" data-mode="custom">Select</button>
                            </div>
                        </div>

                        <!-- Mode Configuration Section (shown after selecting a mode) -->
                        <div id="mode-config-section" class="mode-config-section hidden">
                            <div class="mode-config-header">
                                <button type="button" id="back-to-modes" class="btn-back">‚Üê Back to modes</button>
                                <h4 id="mode-config-title" class="mode-config-title"></h4>
                            </div>

                            <div id="mode-config-content" class="mode-config-content">
                                <!-- Configuration UI will be dynamically inserted here -->
                            </div>
                        </div>

                        <!-- Legacy model selection (hidden, kept for backward compatibility) -->
                        <div id="legacy-model-selection" class="hidden">

                        <!-- Model Selection -->
                        <div class="model-selection-group">
                            <label for="model-select" class="model-select-label">Select AI Model</label>
                            <select id="model-select" class="model-select-dropdown">
                                <optgroup label="Cloud Models (Require API Key)">
                                    <option value="gemini-2.0-flash" data-provider="gemini">Gemini 2.0 Flash (Fast & Efficient)</option>
                                    <option value="gemini-1.5-pro" data-provider="gemini">Gemini 1.5 Pro (Advanced Reasoning)</option>
                                    <option value="gpt-4o" data-provider="openai">GPT-4o (Multimodal)</option>
                                    <option value="gpt-4-turbo" data-provider="openai">GPT-4 Turbo (Advanced)</option>
                                    <option value="gpt-3.5-turbo" data-provider="openai">GPT-3.5 Turbo (Fast)</option>
                                    <option value="claude-3-5-sonnet" data-provider="anthropic">Claude 3.5 Sonnet (Top Performance)</option>
                                    <option value="claude-3-opus" data-provider="anthropic">Claude 3 Opus (Most Capable)</option>
                                </optgroup>
                                <optgroup label="Local Models (No API Key)">
                                    <!-- Ollama models will be dynamically populated from your system -->
                                    <option value="web-llm" data-provider="web">Web LLM (Browser-based)</option>
                                    <option value="paxos" data-provider="paxos">Paxos (Requires Upgrade)</option>
                                </optgroup>
                                <optgroup label="Advanced">
                                    <option value="custom-proxy" data-provider="custom">Custom Proxy/Endpoint</option>
                                </optgroup>
                            </select>
                            <small id="model-description" class="model-description">Choose a model from the list above</small>
                        </div>

                        <!-- API Key Section (shown conditionally) -->
                        <div id="api-key-section" class="api-key-section hidden">
                            <div class="api-key-input">
                                <label for="api-key-input" id="api-key-label">API Key</label>
                                <input type="password" id="api-key-input" placeholder="Enter your API key" />
                                <small id="api-key-help">Your API key will be stored securely in your browser</small>
                            </div>
                        </div>

                        <!-- Local Model Configuration (shown for Ollama) -->
                        <div id="local-config-section" class="local-config-section hidden">
                            <div class="api-key-input">
                                <label for="local-endpoint">Ollama Endpoint</label>
                                <input type="text" id="local-endpoint" placeholder="http://localhost:11434" value="http://localhost:11434" />
                                <small>Make sure Ollama is running: <code>ollama serve</code></small>
                            </div>
                            <div class="api-key-input" id="custom-model-name-container" style="margin-top: 10px;">
                                <label for="local-model">Model Name</label>
                                <input type="text" id="local-model" placeholder="e.g., llama3:latest, gpt-oss:120b" />
                                <small>The model name will be auto-filled when you select from the dropdown</small>
                            </div>
                        </div>

                        <!-- Custom Proxy Configuration -->
                        <div id="custom-proxy-section" class="custom-proxy-section hidden">
                            <div class="api-key-input">
                                <label for="custom-proxy-url">Custom Proxy URL</label>
                                <input type="text" id="custom-proxy-url" placeholder="http://localhost:8000/api" />
                                <small>Enter the full URL to your custom endpoint</small>
                            </div>
                            <div class="api-key-input" style="margin-top: 10px;">
                                <label for="custom-api-key">API Key (Optional)</label>
                                <input type="password" id="custom-api-key" placeholder="If your proxy requires authentication" />
                            </div>
                        </div>

                        <!-- Paxos Notice -->
                        <div id="paxos-notice" class="paxos-notice hidden">
                            <p>‚ö† Paxos requires the PAXS upgrade to be loaded. Make sure to include it in your boot configuration.</p>
                        </div>

                        </div>
                        <!-- End legacy model selection -->
                    </div>

                    <!-- Advanced Settings Tab Content -->
                    <div class="modal-tab-content" id="modal-advanced-tab">
                        <p class="settings-description">
                            Fine-tune experimental features and network connectivity.
                        </p>

                        <!-- Network & P2P Settings -->
                        <div class="settings-section">
                            <h4 class="settings-section-title">Network & P2P</h4>
                            <div class="setting-item">
                                <label class="setting-checkbox-label">
                                    <span class="custom-checkbox">
                                        <input type="checkbox" id="enable-webrtc-modal" />
                                        <span class="custom-checkbox-box"></span>
                                    </span>
                                    <span class="setting-checkbox-text">Enable WebRTC Swarm (P2P Connections)</span>
                                </label>
                                <p class="setting-description">‚ö† Allows peer-to-peer connections with other Reploid instances. Disabled by default for security.</p>
                            </div>
                        </div>

                        <!-- Future settings sections can go here -->
                        <div class="settings-section">
                            <h4 class="settings-section-title">Developer Options</h4>
                            <div class="setting-item">
                                <p class="setting-placeholder">Additional developer settings will appear here in future updates.</p>
                            </div>
                        </div>
                    </div>

                    <button id="save-keys-btn" class="btn primary">Save Configuration</button>
                </div>
            </div>
        </div>

        <!-- Goal Input at Top -->
        <div class="goal-container-top">
            <div class="goal-context">
                <p class="goal-context-tagline">Reploid launches an autonomous builder to plan, iterate, and ship for you.</p>
                <p class="goal-context-examples">Try goals like ‚ÄúDesign a marketing site‚Äù, ‚ÄúRefactor my API layer‚Äù, or ‚ÄúDraft onboarding docs‚Äù.</p>
            </div>
            <div class="goal-input-group">
                <input type="text" id="goal-input" placeholder="Describe your goal..." maxlength="500" />
                <button id="awaken-btn" class="btn primary">Launch Agent</button>
            </div>
        </div>

        <!-- Configuration Tabs -->
        <div class="config-section">
            <div class="config-tabs">
                <button class="config-tab active" data-tab="simple">
                    <span class="tab-text">‚ñ∏ Quick Start</span>
                </button>
                <button class="config-tab" data-tab="templates">
                    <span class="tab-text">‚ñ¶ Presets</span>
                </button>
                <button class="config-tab" data-tab="hunter">
                    <span class="tab-text">‚óé Custom</span>
                </button>
            </div>

            <!-- Simple Mode Tab Content (NEW) -->
            <div class="tab-content active" id="simple-tab">
                <div class="simple-mode-container">
                    <p class="simple-mode-subtitle">
                        Choose which
                        <button type="button" class="link-button" data-popover="modules" aria-label="What are modules?">modules ‚ìò</button>
                        and
                        <button type="button" class="link-button" data-popover="blueprints" aria-label="What are blueprints?">blueprints ‚ìò</button>
                        load at startup
                        <button type="button" class="browse-link" onclick="window.openDirectoryBrowser('modules')" aria-label="Browse all modules and blueprints">Browse all ‚Üí</button>
                    </p>

                    <div class="boot-mode-options">
                        <button class="boot-mode-btn selected" data-mode="minimal" onclick="selectBootMode('minimal')">
                            <div class="boot-mode-label">Minimal Core</div>
                            <div class="boot-mode-desc">Lean reasoning and safety stack for rapid spins.</div>
                        </button>

                        <button class="boot-mode-btn" data-mode="all-blueprints" onclick="selectBootMode('all-blueprints')">
                            <div class="boot-mode-label">Core + Knowledge</div>
                            <div class="boot-mode-desc">Boot with guides, playbooks, and docs for richer context.</div>
                        </button>

                        <button class="boot-mode-btn" data-mode="all-upgrades" onclick="selectBootMode('all-upgrades')">
                            <div class="boot-mode-label">Full Arsenal</div>
                            <div class="boot-mode-desc">Everything enabled from the start‚Äîautomation, analysis, and blueprints.</div>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Templates Tab Content -->
            <div class="tab-content" id="templates-tab">
                <div id="persona-selection-container">
                    <!-- Persona cards will be dynamically inserted here -->
                </div>
            </div>

            <!-- Hunter Protocol Tab Content -->
            <div class="tab-content" id="hunter-tab">
                <div id="advanced-options">
                    <!-- Advanced selection UI will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Info Overlay -->
        <div id="info-overlay" class="info-overlay hidden">
            <div class="info-card">
                <div class="info-card-header">
                    <h3 id="info-card-title">Info</h3>
                    <button type="button" class="close-btn" onclick="window.closeInfoCard()">√ó</button>
                </div>
                <div id="info-card-body" class="info-card-body"></div>
                <div class="info-card-footer">
                    <button type="button" id="info-card-browse" class="secondary-btn">Browse Directory ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Directory Browser -->
        <div id="directory-modal" class="modal hidden">
            <div class="modal-content directory-modal-content">
                <div class="modal-header">
                    <h3 id="directory-modal-title">Module & Blueprint Directory</h3>
                    <button type="button" class="close-btn" onclick="window.closeDirectoryModal()">√ó</button>
                </div>
                <div class="modal-body directory-modal-body">
                    <div class="directory-toolbar">
                        <div class="directory-tabs">
                            <button type="button" class="directory-tab active" data-category="modules">Modules</button>
                            <button type="button" class="directory-tab" data-category="blueprints">Blueprints</button>
                        </div>
                        <input type="text" id="directory-search" class="directory-search" placeholder="Search..." aria-label="Search modules and blueprints" />
                    </div>
                    <div class="directory-filters" role="group" aria-label="Filter by preset">
                        <button type="button" class="directory-filter active" data-filter="all">All Presets</button>
                        <button type="button" class="directory-filter" data-filter="minimal">Minimal Core</button>
                        <button type="button" class="directory-filter" data-filter="knowledge">Core + Knowledge</button>
                        <button type="button" class="directory-filter" data-filter="full">Full Arsenal</button>
                    </div>
                    <div class="directory-content" id="directory-content"></div>
                </div>
            </div>
        </div>

        <div id="help-popover" class="help-popover hidden" role="dialog" aria-modal="false" aria-hidden="true">
            <div class="help-popover-content">
                <div class="help-popover-header">
                    <div id="help-popover-title" class="help-popover-title">Help</div>
                    <button type="button" class="close-btn help-popover-close" aria-label="Close help popover">√ó</button>
                </div>
                <div id="help-popover-body" class="help-popover-body"></div>
            </div>
        </div>

        <div id="multi-model-modal" class="modal hidden" role="dialog" aria-modal="true" aria-hidden="true">
            <div class="modal-content multi-model-modal-content">
                <div class="modal-header">
                    <h3>Multi-Model Setup</h3>
                    <button type="button" class="close-btn" id="close-multi-model">√ó</button>
                </div>
                <div class="modal-body">
                    <p class="settings-description">Define primary, fallback, and consensus models for Paxos orchestration.</p>
                    <div class="paxos-field">
                        <label for="paxos-primary">Primary Model</label>
                        <input type="text" id="paxos-primary" placeholder="e.g., gemini-2.0-flash" />
                    </div>
                    <div class="paxos-field">
                        <label for="paxos-fallback">Fallback Model</label>
                        <input type="text" id="paxos-fallback" placeholder="e.g., gpt-4o" />
                    </div>
                    <div class="paxos-field">
                        <label for="paxos-consensus">Consensus Model</label>
                        <input type="text" id="paxos-consensus" placeholder="e.g., claude-3-opus" />
                    </div>
                    <div class="paxos-field">
                        <label for="paxos-strategy">Strategy</label>
                        <select id="paxos-strategy">
                            <option value="fastest">Fastest First</option>
                            <option value="consensus">Consensus Vote</option>
                            <option value="fallback">Fallback Chain</option>
                        </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn secondary" id="cancel-multi-model">Cancel</button>
                        <button type="button" class="btn primary" id="save-multi-model">Save Multi-Model Plan</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="app-root" style="display: none;"></div>

            <script src="https://unpkg.com/@isomorphic-git/lightning-fs"></script>
    <script src="https://unpkg.com/isomorphic-git"></script>
    <script type="module" src="https://unpkg.com/isomorphic-git/http/web/index.js"></script>
    <script src="boot.js"></script>
</body>
</html>
