<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' style='stop-color:%230ff;'/><stop offset='100%25' style='stop-color:%23ffd700;'/></linearGradient></defs><text fill='url(%23g)' y='.99em' font-size='90' font-weight='bold'>R</text></svg>" />
    <title>REPLOID - AI Assistant</title>
    <link rel="stylesheet" href="boot/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/acorn@8.12.1/dist/acorn.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
    <!-- Web LLM library loaded via esm.run CDN - loaded dynamically when needed by local-llm.js module -->
    <!-- <script type="module" src="https://esm.run/@mlc-ai/web-llm"></script> -->

    <!-- Firebase Analytics -->
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
      import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';

      const firebaseConfig = {
        apiKey: "AIzaSyBNjEuGLafsUde3ws_9_Zi-PUlKkWt-CWM",
        authDomain: "reploid.firebaseapp.com",
        projectId: "reploid",
        storageBucket: "reploid.firebasestorage.app",
        messagingSenderId: "506730551098",
        appId: "1:506730551098:web:1b9639865cb8501b7c2203",
        measurementId: "G-RL299QYBNB"
      };

      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
    </script>
</head>
<body>
    <div id="boot-container">
        <div class="boot-header">
            <h1>REPLOID</h1>
            <p class="subtitle">
                <a href="about.html" target="_blank" class="subtitle-link">[Experimental] Recursive Self-Improvement Ecosystem</a>
            </p>
        </div>

        <!-- Status and Config at Top -->
        <div class="status-bar">
            <div class="status-item">
                <span class="status-label">Server</span>
                <div>
                    <span id="api-status" class="status-value">⚙ Checking...</span>
                    <div id="api-status-detail" class="status-value-detail"></div>
                </div>
            </div>
            <div class="status-item">
                <span class="status-label">AI Model</span>
                <div>
                    <span id="provider-status" class="status-value">-</span>
                    <div id="provider-status-detail" class="status-value-detail"></div>
                </div>
            </div>
            <button id="config-btn" class="btn-config" title="Configure Settings">⚙ Settings</button>
        </div>

        <div id="api-error-message" class="error-message hidden">
            <strong>⚠ Server Offline</strong>
            <p>The REPLOID server at <code>localhost:8000</code> is not responding.</p>
            <p>Start the server: <code>npm start</code></p>
        </div>

        <!-- Settings Modal -->
        <div id="config-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Settings</h3>
                    <button id="close-modal" class="close-btn">×</button>
                </div>
                <div class="modal-body">
                    <!-- Modal Tabs -->
                    <div class="modal-tabs">
                        <button class="modal-tab active" data-modal-tab="model">Model & API</button>
                        <button class="modal-tab" data-modal-tab="advanced">Advanced</button>
                    </div>

                    <!-- Model & API Tab Content -->
                    <div class="modal-tab-content active" id="modal-model-tab">
                        <p class="modal-tab-description">Select an AI model to power your agent. API keys are stored locally in your browser.</p>

                    <!-- Model Selection -->
                    <div class="model-selection-group">
                        <label for="model-select" class="model-select-label">Select AI Model</label>
                        <select id="model-select" class="model-select-dropdown">
                            <optgroup label="Cloud Models (Require API Key)">
                                <option value="gemini-2.0-flash" data-provider="gemini">Gemini 2.0 Flash (Fast & Efficient)</option>
                                <option value="gemini-1.5-pro" data-provider="gemini">Gemini 1.5 Pro (Advanced Reasoning)</option>
                                <option value="gpt-4o" data-provider="openai">GPT-4o (Multimodal)</option>
                                <option value="gpt-4-turbo" data-provider="openai">GPT-4 Turbo (Advanced)</option>
                                <option value="gpt-3.5-turbo" data-provider="openai">GPT-3.5 Turbo (Fast)</option>
                                <option value="claude-3-5-sonnet" data-provider="anthropic">Claude 3.5 Sonnet (Top Performance)</option>
                                <option value="claude-3-opus" data-provider="anthropic">Claude 3 Opus (Most Capable)</option>
                            </optgroup>
                            <optgroup label="Local Models (No API Key)">
                                <option value="ollama-llama3" data-provider="local">Llama 3 (via Ollama)</option>
                                <option value="ollama-mistral" data-provider="local">Mistral (via Ollama)</option>
                                <option value="ollama-codellama" data-provider="local">CodeLlama (via Ollama)</option>
                                <option value="ollama-custom" data-provider="local">Custom Ollama Model</option>
                                <option value="web-llm" data-provider="web">Web LLM (Browser-based)</option>
                                <option value="paxos" data-provider="paxos">Paxos (Requires Upgrade)</option>
                            </optgroup>
                            <optgroup label="Advanced">
                                <option value="custom-proxy" data-provider="custom">Custom Proxy/Endpoint</option>
                            </optgroup>
                        </select>
                        <small id="model-description" class="model-description">Choose a model from the list above</small>
                    </div>

                    <!-- API Key Section (shown conditionally) -->
                    <div id="api-key-section" class="api-key-section hidden">
                        <div class="api-key-input">
                            <label for="api-key-input" id="api-key-label">API Key</label>
                            <input type="password" id="api-key-input" placeholder="Enter your API key" />
                            <small id="api-key-help">Your API key will be stored securely in your browser</small>
                        </div>
                    </div>

                    <!-- Local Model Configuration (shown for Ollama) -->
                    <div id="local-config-section" class="local-config-section hidden">
                        <div class="api-key-input">
                            <label for="local-endpoint">Ollama Endpoint</label>
                            <input type="text" id="local-endpoint" placeholder="http://localhost:11434" value="http://localhost:11434" />
                            <small>Make sure Ollama is running: <code>ollama serve</code></small>
                        </div>
                        <div class="api-key-input" id="custom-model-name-container" style="margin-top: 10px;">
                            <label for="local-model">Model Name</label>
                            <input type="text" id="local-model" placeholder="e.g., llama3, mistral, codellama" />
                            <small>Enter the exact model name from <code>ollama list</code></small>
                        </div>
                    </div>

                    <!-- Custom Proxy Configuration -->
                    <div id="custom-proxy-section" class="custom-proxy-section hidden">
                        <div class="api-key-input">
                            <label for="custom-proxy-url">Custom Proxy URL</label>
                            <input type="text" id="custom-proxy-url" placeholder="http://localhost:8000/api" />
                            <small>Enter the full URL to your custom endpoint</small>
                        </div>
                        <div class="api-key-input" style="margin-top: 10px;">
                            <label for="custom-api-key">API Key (Optional)</label>
                            <input type="password" id="custom-api-key" placeholder="If your proxy requires authentication" />
                        </div>
                    </div>

                    <!-- Paxos Notice -->
                    <div id="paxos-notice" class="paxos-notice hidden">
                        <p>⚠ Paxos requires the PAXS upgrade to be loaded. Make sure to include it in your boot configuration.</p>
                    </div>
                    </div>

                    <!-- Advanced Tab Content -->
                    <div class="modal-tab-content" id="modal-advanced-tab">
                        <p class="modal-tab-description">Configure advanced features and network settings.</p>

                        <!-- Network & P2P Settings -->
                        <div class="settings-section">
                            <h4 class="settings-section-title">Network & P2P</h4>
                            <div class="setting-item">
                                <label class="setting-checkbox-label">
                                    <span class="custom-checkbox">
                                        <input type="checkbox" id="enable-webrtc-modal" />
                                        <span class="custom-checkbox-box"></span>
                                    </span>
                                    <span class="setting-checkbox-text">Enable WebRTC Swarm (P2P Connections)</span>
                                </label>
                                <p class="setting-description">⚠ Allows peer-to-peer connections with other Reploid instances. Disabled by default for security.</p>
                            </div>
                        </div>

                        <!-- Future settings sections can go here -->
                        <div class="settings-section">
                            <h4 class="settings-section-title">Developer Options</h4>
                            <div class="setting-item">
                                <p class="setting-placeholder">Additional developer settings will appear here in future updates.</p>
                            </div>
                        </div>
                    </div>

                    <button id="save-keys-btn" class="btn primary">Save Configuration</button>
                </div>
            </div>
        </div>

        <!-- Goal Input at Top -->
        <div class="goal-container-top">
            <div class="goal-input-group">
                <input type="text" id="goal-input" placeholder="What is your goal? (e.g., Create a landing page, Refactor my code, Write an RFC...)" maxlength="500" />
                <button id="awaken-btn" class="btn primary">Launch Agent</button>
            </div>
        </div>

        <!-- Configuration Tabs -->
        <div class="config-section">
            <div class="config-tabs">
                <button class="config-tab active" data-tab="simple">
                    <span class="tab-text">▸ Quick Start</span>
                </button>
                <button class="config-tab" data-tab="templates">
                    <span class="tab-text">▦ Presets</span>
                </button>
                <button class="config-tab" data-tab="hunter">
                    <span class="tab-text">◎ Custom</span>
                </button>
            </div>

            <div class="tab-description">
                <p id="tab-description-text">Choose your starting configuration - from minimal core to full power</p>
            </div>

            <!-- Simple Mode Tab Content (NEW) -->
            <div class="tab-content active" id="simple-tab">
                <div class="simple-mode-container">
                    <h3 class="simple-mode-title">Choose Your Starting Configuration</h3>
                    <p class="simple-mode-subtitle">These options control which modules and blueprints load at startup</p>

                    <div class="boot-mode-options">
                        <button class="boot-mode-btn selected" data-mode="minimal" onclick="selectBootMode('minimal')">
                            <div class="boot-mode-label">▸ Minimal RSI Core</div>
                            <div class="boot-mode-desc">10 essential modules only - fastest startup, agent can self-evolve</div>
                            <div class="boot-mode-modules">APPL, UTIL, STMT, LSTR, APIC, CYCL, TLRD, TLWR, LLMR, HYBR</div>
                        </button>

                        <button class="boot-mode-btn" data-mode="all-blueprints" onclick="selectBootMode('all-blueprints')">
                            <div class="boot-mode-label">▦ Core + All Blueprints</div>
                            <div class="boot-mode-desc">10 core modules + 62 blueprints for maximum knowledge</div>
                            <div class="boot-mode-modules">Minimal + all .md knowledge documents</div>
                        </button>

                        <button class="boot-mode-btn" data-mode="all-upgrades" onclick="selectBootMode('all-upgrades')">
                            <div class="boot-mode-label">⬢ All Upgrades + Blueprints</div>
                            <div class="boot-mode-desc">62 upgrades + 62 blueprints - full power from the start</div>
                            <div class="boot-mode-modules">Every available capability enabled</div>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Templates Tab Content -->
            <div class="tab-content" id="templates-tab">
                <div id="persona-selection-container">
                    <!-- Persona cards will be dynamically inserted here -->
                </div>
            </div>

            <!-- Hunter Protocol Tab Content -->
            <div class="tab-content" id="hunter-tab">
                <div id="advanced-options">
                    <!-- Advanced selection UI will be rendered here -->
                </div>
            </div>
        </div>
    </div>
    <div id="app-root" style="display: none;"></div>

            <script src="https://unpkg.com/@isomorphic-git/lightning-fs"></script>
    <script src="https://unpkg.com/isomorphic-git"></script>
    <script src="https://unpkg.com/isomorphic-git/http/web/index.js"></script>
    <script src="boot.js"></script>
</body>
</html>
