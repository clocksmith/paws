<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' style='stop-color:%230ff;'/><stop offset='100%25' style='stop-color:%23ffd700;'/></linearGradient></defs><text fill='url(%23g)' y='.99em' font-size='90' font-weight='bold'>R</text></svg>" />
    <title>REPLOID - AI Assistant</title>
    <link rel="stylesheet" href="boot/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/acorn@8.12.1/dist/acorn.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-typescript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markup.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
    <!-- Web LLM library loaded via esm.run CDN - loaded dynamically when needed by local-llm.js module -->
    <script type="module" src="https://esm.run/@mlc-ai/web-llm"></script>

    <!-- Firebase Analytics -->
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
      import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';

      const firebaseConfig = {
        apiKey: "AIzaSyBNjEuGLafsUde3ws_9_Zi-PUlKkWt-CWM",
        authDomain: "reploid.firebaseapp.com",
        projectId: "reploid",
        storageBucket: "reploid.firebasestorage.app",
        messagingSenderId: "506730551098",
        appId: "1:506730551098:web:1b9639865cb8501b7c2203",
        measurementId: "G-RL299QYBNB"
      };

      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
    </script>
</head>
<body>
    <div id="boot-container">
        <div class="boot-header">
            <h1>REPLOID</h1>
            <p class="subtitle">
                <a href="about.html" target="_blank" class="subtitle-link">[Experimental] Recursive Self-Improvement Ecosystem</a>
            </p>
        </div>

        <!-- Model Picker (Main Boot Screen) -->
        <div id="model-picker-section" class="model-picker-section">
            <!-- Selected Models Chips -->
            <div class="selected-models-chips">
                <h4>Selected Models</h4>
                <div id="selected-chips-container" class="chips-container">
                    <div class="empty-chips-state" id="chips-empty-state">
                        <p>► Select at least one model to continue</p>
                    </div>
                </div>
            </div>

            <!-- Available Models -->
            <div class="available-models-section">
                <h4>Available Models <span class="hint-text">(click to configure)</span></h4>

                <!-- Cloud Providers Row -->
                <div class="providers-row">
                    <!-- Gemini -->
                    <div class="provider-card" id="provider-gemini" data-provider="gemini">
                        <div class="provider-card-header">
                            <span class="provider-icon">▲</span>
                            <h5>Gemini</h5>
                            <span class="provider-status" id="gemini-status">Configure</span>
                        </div>
                        <div class="provider-card-body hidden" id="gemini-config">
                            <div class="api-key-input-group">
                                <label>API Key:</label>
                                <input type="password" id="gemini-api-key" placeholder="Enter Gemini API key" />
                                <button type="button" class="btn-verify" data-provider="gemini">Verify</button>
                            </div>
                            <div class="models-list hidden" id="gemini-models-list"></div>
                            <div class="query-method">
                                <label>Query Method:</label>
                                <label><input type="radio" name="gemini-query" value="browser" checked/> Browser-Direct</label>
                                <label><input type="radio" name="gemini-query" value="proxy" /> Via Proxy</label>
                            </div>
                            <button type="button" class="btn-add-selected" data-provider="gemini" disabled>Add Selected Models</button>
                        </div>
                    </div>

                    <!-- OpenAI -->
                    <div class="provider-card" id="provider-openai" data-provider="openai">
                        <div class="provider-card-header">
                            <span class="provider-icon">▲</span>
                            <h5>OpenAI</h5>
                            <span class="provider-status" id="openai-status">Configure</span>
                        </div>
                        <div class="provider-card-body hidden" id="openai-config">
                            <div class="api-key-input-group">
                                <label>API Key:</label>
                                <input type="password" id="openai-api-key" placeholder="Enter OpenAI API key" />
                                <button type="button" class="btn-verify" data-provider="openai">Verify</button>
                            </div>
                            <div class="models-list hidden" id="openai-models-list"></div>
                            <div class="query-method">
                                <label>Query Method:</label>
                                <label><input type="radio" name="openai-query" value="browser" checked/> Browser-Direct</label>
                                <label><input type="radio" name="openai-query" value="proxy" /> Via Proxy</label>
                            </div>
                            <button type="button" class="btn-add-selected" data-provider="openai" disabled>Add Selected Models</button>
                        </div>
                    </div>

                    <!-- Anthropic -->
                    <div class="provider-card" id="provider-anthropic" data-provider="anthropic">
                        <div class="provider-card-header">
                            <span class="provider-icon">▲</span>
                            <h5>Anthropic</h5>
                            <span class="provider-status" id="anthropic-status">Configure</span>
                        </div>
                        <div class="provider-card-body hidden" id="anthropic-config">
                            <div class="api-key-input-group">
                                <label>API Key:</label>
                                <input type="password" id="anthropic-api-key" placeholder="Enter Anthropic API key" />
                                <button type="button" class="btn-verify" data-provider="anthropic">Verify</button>
                            </div>
                            <div class="models-list hidden" id="anthropic-models-list"></div>
                            <div class="query-method">
                                <label>Query Method:</label>
                                <label><input type="radio" name="anthropic-query" value="browser" checked/> Browser-Direct</label>
                                <label><input type="radio" name="anthropic-query" value="proxy" /> Via Proxy</label>
                            </div>
                            <button type="button" class="btn-add-selected" data-provider="anthropic" disabled>Add Selected Models</button>
                        </div>
                    </div>
                </div>

                <!-- Local Models Row -->
                <div class="local-models-row">
                    <!-- Ollama -->
                    <div class="provider-card local-provider" id="provider-ollama" data-provider="ollama">
                        <div class="provider-card-header">
                            <span class="provider-icon">■</span>
                            <h5>Ollama</h5>
                            <span class="provider-status" id="ollama-status">Detecting...</span>
                        </div>
                        <div class="provider-card-body hidden" id="ollama-config">
                            <div class="models-list" id="ollama-models-list"></div>
                            <button type="button" class="btn-add-selected" data-provider="ollama" disabled>Add Selected Models</button>
                        </div>
                    </div>

                    <!-- WebLLM -->
                    <div class="provider-card local-provider" id="provider-webllm" data-provider="webllm">
                        <div class="provider-card-header">
                            <span class="provider-icon">◆</span>
                            <h5>WebLLM</h5>
                            <span class="provider-status" id="webllm-status">Detecting...</span>
                        </div>
                        <div class="provider-card-body hidden" id="webllm-config">
                            <div class="models-list" id="webllm-models-list"></div>
                            <button type="button" class="btn-add-selected" data-provider="webllm" disabled>Add Selected Models</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Consensus Strategy -->
            <div id="consensus-section" class="consensus-section hidden">
                <label for="consensus-strategy">Consensus Strategy (2+ models)</label>
                <select id="consensus-strategy" class="consensus-select">
                    <option value="arena">Model Arena</option>
                    <option value="peer-review">Peer Review</option>
                </select>
            </div>

            <!-- Auto-Approve Toggle Card -->
            <div class="auto-approve-card-compact" id="auto-approve-card" data-enabled="false">
                <input type="checkbox" id="auto-approve-toggle" style="display: none;" />
                <div class="auto-approve-content">
                    <span class="auto-approve-label">◈ Auto-Approve Context</span>
                    <span class="auto-approve-hint">Auto-approve context curation (not code changes)</span>
                </div>
            </div>
        </div>

        <!-- Legacy Detection Markers (hidden) -->
        <div style="display: none;">
            <div id="provider-status"></div>
            <div id="provider-status-detail"></div>
        </div>

        <!-- Goal Input at Top -->
        <div class="goal-container-top">
            <div class="goal-context">
                <p class="goal-context-tagline">Where AI agents propose, critique, and evolve their own capabilities.</p>
                <p class="goal-context-examples">Try goals like "Create tools to make tools to make tools" or "Analyze your own inefficiency patterns and improve yourself".</p>
            </div>
            <div class="goal-input-group">
                <input type="text" id="goal-input" placeholder="► Select at least one model to continue" maxlength="500" disabled />
                <button id="awaken-btn" class="btn primary" disabled>Awaken Agent</button>
            </div>
        </div>

        <!-- Configuration Tabs -->
        <div class="config-section">
            <div class="config-tabs">
                <button class="config-tab active" data-tab="simple">
                    <span class="tab-text">▸ Quick Start</span>
                </button>
                <button class="config-tab" data-tab="templates">
                    <span class="tab-text">▦ Presets</span>
                </button>
                <button class="config-tab" data-tab="hunter">
                    <span class="tab-text">◎ Custom</span>
                </button>
            </div>

            <!-- Simple Mode Tab Content (NEW) -->
            <div class="tab-content active" id="simple-tab">
                <div class="simple-mode-container">
                    <p class="simple-mode-subtitle">
                        Choose which
                        <button type="button" class="link-button" data-popover="modules" aria-label="What are modules?">modules ⓘ</button>
                        and
                        <button type="button" class="link-button" data-popover="blueprints" aria-label="What are blueprints?">blueprints ⓘ</button>
                        load at startup
                        <button type="button" class="browse-link" onclick="window.openDirectoryBrowser('modules')" aria-label="Browse all modules and blueprints">Browse all →</button>
                    </p>

                    <div class="boot-mode-options">
                        <button class="boot-mode-btn selected" data-mode="minimal" onclick="selectBootMode('minimal')">
                            <div class="boot-mode-label">Standard RSI</div>
                            <div class="boot-mode-desc">23 modules — Complete RSI with streaming, context management, hybrid LLM, and tool creation.</div>
                        </button>

                        <button class="boot-mode-btn" data-mode="all-blueprints" onclick="selectBootMode('all-blueprints')">
                            <div class="boot-mode-label">RSI + Guides</div>
                            <div class="boot-mode-desc">23 modules + 100 blueprints — Standard RSI plus all architectural guides and patterns.</div>
                        </button>

                        <button class="boot-mode-btn" data-mode="all-upgrades" onclick="selectBootMode('all-upgrades')">
                            <div class="boot-mode-label">Complete System</div>
                            <div class="boot-mode-desc">87 modules + 100 blueprints — Full stack with visualization, Python, monitoring, swarm, multi-provider.</div>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Templates Tab Content -->
            <div class="tab-content" id="templates-tab">
                <div id="persona-selection-container">
                    <!-- Persona cards will be dynamically inserted here -->
                </div>
            </div>

            <!-- Hunter Protocol Tab Content -->
            <div class="tab-content" id="hunter-tab">
                <div id="advanced-options">
                    <!-- Advanced selection UI will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Info Overlay -->
        <div id="info-overlay" class="info-overlay hidden">
            <div class="info-card">
                <div class="info-card-header">
                    <h3 id="info-card-title">Info</h3>
                    <button type="button" class="close-btn" onclick="window.closeInfoCard()">×</button>
                </div>
                <div id="info-card-body" class="info-card-body"></div>
                <div class="info-card-footer">
                    <button type="button" id="info-card-browse" class="secondary-btn">Browse Directory →</button>
                </div>
            </div>
        </div>

        <!-- Directory Browser -->
        <div id="directory-modal" class="modal hidden">
            <div class="modal-content directory-modal-content">
                <div class="modal-header">
                    <h3 id="directory-modal-title">Module & Blueprint Directory</h3>
                    <button type="button" class="close-btn" onclick="window.closeDirectoryModal()">×</button>
                </div>
                <div class="modal-body directory-modal-body">
                    <div class="directory-toolbar">
                        <div class="directory-tabs">
                            <button type="button" class="directory-tab active" data-category="modules">Modules</button>
                            <button type="button" class="directory-tab" data-category="blueprints">Blueprints</button>
                        </div>
                        <input type="text" id="directory-search" class="directory-search" placeholder="Search..." aria-label="Search modules and blueprints" />
                    </div>
                    <div class="directory-filters" role="group" aria-label="Filter by preset">
                        <button type="button" class="directory-filter active" data-filter="all">All Presets</button>
                        <button type="button" class="directory-filter" data-filter="minimal">Minimal Core</button>
                        <button type="button" class="directory-filter" data-filter="knowledge">Core + Knowledge</button>
                        <button type="button" class="directory-filter" data-filter="full">Full Arsenal</button>
                    </div>
                    <div class="directory-content" id="directory-content"></div>
                </div>
            </div>
        </div>

        <div id="help-popover" class="help-popover hidden" role="dialog" aria-modal="false" aria-hidden="true">
            <div class="help-popover-content">
                <div class="help-popover-header">
                    <div id="help-popover-title" class="help-popover-title">Help</div>
                    <button type="button" class="close-btn help-popover-close" aria-label="Close help popover">×</button>
                </div>
                <div id="help-popover-body" class="help-popover-body"></div>
            </div>
        </div>

        <div id="multi-model-modal" class="modal hidden" role="dialog" aria-modal="true" aria-hidden="true">
            <div class="modal-content multi-model-modal-content">
                <div class="modal-header">
                    <h3>Multi-Model Setup</h3>
                    <button type="button" class="close-btn" id="close-multi-model">×</button>
                </div>
                <div class="modal-body">
                    <p class="settings-description">Define primary, fallback, and consensus models for Paxos orchestration.</p>
                    <div class="paxos-field">
                        <label for="paxos-primary">Primary Model</label>
                        <input type="text" id="paxos-primary" placeholder="e.g., gemini-2.5-flash-lite" />
                    </div>
                    <div class="paxos-field">
                        <label for="paxos-fallback">Fallback Model</label>
                        <input type="text" id="paxos-fallback" placeholder="e.g., gpt-5-2025-08-07" />
                    </div>
                    <div class="paxos-field">
                        <label for="paxos-consensus">Consensus Model</label>
                        <input type="text" id="paxos-consensus" placeholder="e.g., claude-4-5-sonnet" />
                    </div>
                    <div class="paxos-field">
                        <label for="paxos-strategy">Strategy</label>
                        <select id="paxos-strategy">
                            <option value="fastest">Fastest First</option>
                            <option value="consensus">Consensus Vote</option>
                            <option value="fallback">Fallback Chain</option>
                        </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn secondary" id="cancel-multi-model">Cancel</button>
                        <button type="button" class="btn primary" id="save-multi-model">Save Multi-Model Plan</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div id="app-root" style="display: none;"></div>

            <script src="https://unpkg.com/@isomorphic-git/lightning-fs"></script>
    <script src="https://unpkg.com/isomorphic-git"></script>
    <script type="module" src="https://unpkg.com/isomorphic-git/http/web/index.js"></script>
    <script src="integrations/claude-code/workflows/console-monitor.js"></script>
    <script src="integrations/claude-code/workflows/live-reload.js"></script>
    <script type="module" src="boot.js"></script>
</body>
</html>
